/*
Template Name: HUD - Responsive Bootstrap 5 Admin Template
Version: 2.0.0
Author: Sean Ngu
Website: http://www.seantheme.com/hud/
	----------------------------
		APPS CONTENT TABLE
	----------------------------

	<!-- ======== GLOBAL SCRIPT SETTING ======== -->
  01. Global Variable
  02. Handle Scrollbar
  03. Handle Sidebar Menu
  04. Handle Sidebar Scroll Memory
  05. Handle Card Action
  06. Handle Tooltip & Popover Activation
  07. Handle Scroll to Top Button
  08. Handle hexToRgba
  09. Handle Scroll To
  10. Handle Toggle Class
  11. Handle Theme Panel
  12. Handle CSS Variable
  13. Application Controller
  14. Initialise

	<!-- ======== APPLICATION SETTING ======== -->
	Application Controller
*/



/* 01. Global Variable
------------------------------------------------ */
var app = {
	id: '#app',
	isMobile: ((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) || window.innerWidth < 992),
	bootstrap: {
		tooltip: {
			attr: 'data-bs-toggle="tooltip"'
		},
		popover: {
			attr: 'data-bs-toggle="popover"'
		},
		modal: {
			attr: 'data-bs-toggle="modal"',
			dismissAttr: 'data-bs-dismiss="modal"',
			event: {
				hidden: 'hidden.bs.modal'
			}
		},
		nav: {
			class: 'nav',
			tabs: {
				class: 'nav-tabs',
				activeClass: 'active',
				itemClass: 'nav-item',
				itemLinkClass: 'nav-link'
			}
		}
	},
	header: {
		id: '#header',
		class: 'app-header',
		hasScrollClass: 'has-scroll'
	},
	sidebar: {
		id: '#sidebar',
		class: 'app-sidebar',
		scrollBar: {
			localStorage: 'appSidebarScrollPosition',
			dom: ''
		},
		menu: {
			class: 'menu',
			initAttr: 'data-init',
			animationTime: 0,
			itemClass: 'menu-item',
			itemLinkClass: 'menu-link',
			hasSubClass: 'has-sub',
			activeClass: 'active',
			expandingClass: 'expanding',
			expandClass: 'expand',
			submenu: {
				class: 'menu-submenu',
			}
		},
		mobile: {
			toggleAttr: 'data-toggle="app-sidebar-mobile"',
			dismissAttr: 'data-dismiss="app-sidebar-mobile"',
			toggledClass: 'app-sidebar-mobile-toggled',
			closedClass: 'app-sidebar-mobile-closed',
			backdrop: {
				class: 'app-sidebar-mobile-backdrop'
			}
		},
		minify: {
			toggleAttr: 'data-toggle="app-sidebar-minify"',
			toggledClass: 'app-sidebar-minified',
			cookieName: 'app-sidebar-minified'
		},
		floatSubmenu: {
			id: '#app-sidebar-float-submenu',
			dom: '',
			timeout: '',
			class: 'app-sidebar-float-submenu',
			container: {
				class: 'app-sidebar-float-submenu-container'
			},
			arrow: {
				id: '#app-sidebar-float-submenu-arrow',
				class: 'app-sidebar-float-submenu-arrow'
			},
			line: {
				id: '#app-sidebar-float-submenu-line',
				class: 'app-sidebar-float-submenu-line'
			},
			overflow: {
				class: 'overflow-scroll mh-100vh'
			}
		},
		search: {
			class: 'menu-search',
			toggleAttr: 'data-sidebar-search="true"',
			hideClass: 'd-none',
			foundClass: 'has-text'
		},
		transparent: {
			class: 'app-sidebar-transparent'
		}
	},
	scrollBar: {
		attr: 'data-scrollbar="true"',
		skipMobileAttr: 'data-skip-mobile',
		heightAttr: 'data-height',
		wheelPropagationAttr: 'data-wheel-propagation'
	},
	content: {
		id: '#content',
		class: 'app-content',
		fullHeight: {
			class: 'app-content-full-height'
		},
		fullWidth: {
			class: 'app-content-full-width'
		}
	},
	layout: {
		sidebarLight: {
			class: 'app-with-light-sidebar'
		},
		sidebarEnd: {
			class: 'app-with-end-sidebar'
		},
		sidebarWide: {
			class: 'app-with-wide-sidebar'
		},
		sidebarMinified: {
			class: 'app-sidebar-minified'
		},
		sidebarTwo: {
			class: 'app-with-two-sidebar'
		},
		withoutHeader: {
			class: 'app-without-header'
		},
		withoutSidebar: {
			class: 'app-without-sidebar'
		},
		topMenu: {
			class: 'app-with-top-menu'
		},
		boxedLayout: {
			class: 'boxed-layout'
		}
	},
	scrollToTopBtn: {
		showClass: 'show',
		heightShow: 200,
		toggleAttr: 'data-toggle="scroll-to-top"',
		scrollSpeed: 500
	},
	scrollTo: {
		attr: 'data-toggle="scroll-to"',
		target: 'data-target',
		linkTarget: 'href'
	},
	themePanel: {
		class: 'app-theme-panel',
		toggleAttr: 'data-toggle="theme-panel-expand"',
		cookieName: 'app-theme-panel-expand',
		activeClass: 'active',
		themeListCLass: 'app-theme-list',
		themeListItemCLass: 'app-theme-list-item',
		themeCoverClass: 'app-theme-cover',
		themeCoverItemClass: 'app-theme-cover-item',
		theme: {
			toggleAttr: 'data-toggle="theme-selector"',
			classAttr: 'data-theme-class',
			cookieName: 'app-theme',
			activeClass: 'active'
		},
		themeCover: {
			toggleAttr: 'data-toggle="theme-cover-selector"',
			classAttr: 'data-theme-cover-class',
			cookieName: 'app-theme-cover',
			activeClass: 'active'
		},
		themeMode: {
			toggleAttr: 'data-toggle="theme-mode-selector"',
			valueAttr: 'data-theme-mode',
			cookieName: 'app-theme-mode',
			activeClass: 'active',
			attr: 'data-bs-theme'
		}
	},
	dismissClass: {
		toggleAttr: 'data-dismiss-class',
		targetAttr: 'data-dismiss-target'
	},
	toggleClass: {
		toggleAttr: 'data-toggle-class',
		targetAttr: 'data-toggle-target'
	},
	variablePrefix: 'bs-',
	variableFontList: ['body-font-family', 'body-font-size', 'body-font-weight', 'body-line-height'],
	variableColorList: [
		'theme', 'theme-rgb', 'theme-color', 'theme-color-rgb',
		'default', 'default-rgb',
		'primary', 'primary-rgb', 'primary-bg-subtle', 'primary-text', 'primary-border-subtle',
		'secondary', 'secondary-rgb', 'secondary-bg-subtle', 'secondary-text', 'secondary-border-subtle',
		'success', 'success-rgb', 'success-bg-subtle', 'success-text', 'success-border-subtle',
		'warning', 'warning-rgb', 'warning-bg-subtle', 'warning-text', 'warning-border-subtle',
		'info', 'info-rgb', 'info-bg-subtle', 'info-text', 'info-border-subtle',
		'danger', 'danger-rgb', 'danger-bg-subtle', 'danger-text', 'danger-border-subtle',
		'light', 'light-rgb', 'light-bg-subtle', 'light-text', 'light-border-subtle',
		'dark', 'dark-rgb', 'dark-bg-subtle', 'dark-text', 'dark-border-subtle',
		'inverse', 'inverse-rgb',
		'white', 'white-rgb',
		'black', 'black-rgb',
		'teal', 'teal-rgb',
		'indigo', 'indigo-rgb',
		'purple', 'purple-rgb',
		'yellow', 'yellow-rgb',
		'pink', 'pink-rgb',
		'cyan', 'cyan-rgb',
		'gray-100', 'gray-200', 'gray-300', 'gray-400', 'gray-500',  'gray-600', 'gray-700', 'gray-800', 'gray-900',
		'gray-100-rgb', 'gray-200-rgb', 'gray-300-rgb', 'gray-400-rgb', 'gray-500-rgb',  'gray-600-rgb', 'gray-700-rgb', 'gray-800-rgb', 'gray-900-rgb',
		'muted', 'muted-rgb', 'emphasis-color', 'emphasis-color-rgb',
		'body-bg', 'body-bg-rgb', 'body-color', 'body-color-rgb',
		'heading-color',
		'secondary-color', 'secondary-color-rgb', 'secondary-bg', 'secondary-bg-rgb',
		'tertiary-color', 'tertiary-color-rgb', 'tertiary-bg', 'tertiary-bg-rgb',
		'link-color', 'link-color-rgb', 'link-hover-color', 'link-hover-color-rgb',
		'border-color', 'border-color-translucent'
	],
	font: {},
	color: {},
	card: {
		expand: {
			status: false,
			toggleAttr: 'data-toggle="card-expand"',
			toggleTitle: 'Expand / Compress',
			class: 'card-expand'
		}
	},
	init: {
		attr: 'data-init',
		class: 'app-init'
	}
};



/* 02. Handle Scrollbar
------------------------------------------------ */
var handleScrollbar = function() {
	"use strict";
	var elms = document.querySelectorAll('['+ app.scrollBar.attr +']');

	for (var i = 0; i < elms.length; i++) {
		generateScrollbar(elms[i])
	}
};
var generateScrollbar = function(elm) {
  "use strict";

	if (elm.scrollbarInit || (app.isMobile && elm.getAttribute(app.scrollBar.skipMobileAttr))) {
		return;
	}
	var dataHeight = (!elm.getAttribute(app.scrollBar.heightAttr)) ? elm.offsetHeight : elm.getAttribute(app.scrollBar.heightAttr);

	elm.style.height = dataHeight;
	elm.scrollbarInit = true;

	if(app.isMobile) {
		elm.style.overflowX = 'scroll';
	} else {
		var dataWheelPropagation = (elm.getAttribute(app.scrollBar.wheelPropagationAttr)) ? elm.getAttribute(app.scrollBar.wheelPropagationAttr) : false;

		if (elm.closest('.'+ app.sidebar.class) && elm.closest('.'+ app.sidebar.class).length !== 0) {
			app.sidebar.scrollBar.dom = new PerfectScrollbar(elm, {
				wheelPropagation: dataWheelPropagation
			});
		} else {
			new PerfectScrollbar(elm, {
				wheelPropagation: dataWheelPropagation
			});
		}
	}
	elm.setAttribute(app.init.attr, true);
	elm.classList.remove('invisible');
};



/* 03. Handle Sidebar Menu
------------------------------------------------ */
var handleSidebarMenuToggle = function(menus) {
	menus.map(function(menu) {
		menu.onclick = function(e) {
			e.preventDefault();
			var target = this.nextElementSibling;

			menus.map(function(m) {
				var otherTarget = m.nextElementSibling;
				if (otherTarget !== target) {
					otherTarget.style.display = 'none';
					otherTarget.closest('.'+ app.sidebar.menu.itemClass).classList.remove(app.sidebar.menu.expandClass);
				}
			});

			var targetItemElm = target.closest('.'+ app.sidebar.menu.itemClass);

			if (targetItemElm.classList.contains(app.sidebar.menu.expandClass) || (targetItemElm.classList.contains(app.sidebar.menu.activeClass) && !target.style.display)) {
				targetItemElm.classList.remove(app.sidebar.menu.expandClass);
				target.style.display = 'none';
			} else {
				targetItemElm.classList.add(app.sidebar.menu.expandClass);
				target.style.display = 'block';
			}
		}
	});
};
var handleSidebarMenu = function() {
	"use strict";

	var menuBaseSelector = '.'+ app.sidebar.class +' .'+ app.sidebar.menu.class +' > .'+ app.sidebar.menu.itemClass +'.'+ app.sidebar.menu.hasSubClass;
	var submenuBaseSelector = ' > .'+ app.sidebar.menu.submenu.class +' > .'+ app.sidebar.menu.itemClass + '.' + app.sidebar.menu.hasSubClass;

	// menu
	var menuLinkSelector =  menuBaseSelector + ' > .'+ app.sidebar.menu.itemLinkClass;
	var menus = [].slice.call(document.querySelectorAll(menuLinkSelector));
	handleSidebarMenuToggle(menus);

	// submenu lvl 1
	var submenuLvl1Selector = menuBaseSelector + submenuBaseSelector;
	var submenusLvl1 = [].slice.call(document.querySelectorAll(submenuLvl1Selector + ' > .' + app.sidebar.menu.itemLinkClass));
	handleSidebarMenuToggle(submenusLvl1);

	// submenu lvl 2
	var submenuLvl2Selector = menuBaseSelector + submenuBaseSelector + submenuBaseSelector;
	var submenusLvl2 = [].slice.call(document.querySelectorAll(submenuLvl2Selector + ' > .' + app.sidebar.menu.itemLinkClass));
	handleSidebarMenuToggle(submenusLvl2);
};



/* 04. Handle Sidebar Scroll Memory
------------------------------------------------ */
var handleSidebarScrollMemory = function() {
	if (!app.isMobile) {
		try {
			if (typeof(Storage) !== 'undefined' && typeof(localStorage) !== 'undefined') {
				var elm = document.querySelector('.'+ app.sidebar.class +' ['+ app.scrollBar.attr +']');

				if (elm) {
					elm.onscroll = function() {
						localStorage.setItem(app.sidebar.scrollBar.localStorage, this.scrollTop);
					}
					var defaultScroll = localStorage.getItem(app.sidebar.scrollBar.localStorage);
					if (defaultScroll) {
						document.querySelector('.'+ app.sidebar.class +' ['+ app.scrollBar.attr +']').scrollTop = defaultScroll;
					}
				}
			}
		} catch (error) {
			console.log(error);
		}
	}
};



/* 05. Handle Card Action
------------------------------------------------ */
var handleCardAction = function() {
	"use strict";

	if (app.card.expand.status) {
		return false;
	}
	app.card.expand.status = true;

	// expand
	var expandTogglerList = [].slice.call(document.querySelectorAll('['+ app.card.expand.toggleAttr +']'));
	var expandTogglerTooltipList = expandTogglerList.map(function (expandTogglerEl) {
		expandTogglerEl.onclick = function(e) {
			e.preventDefault();

			var target = this.closest('.card');
			var targetClass = app.card.expand.class;
			var targetTop = 40;

			if (document.body.classList.contains(targetClass) && target.classList.contains(targetClass)) {
				target.removeAttribute('style');
				target.classList.remove(targetClass);
				document.body.classList.remove(targetClass);
			} else {
				document.body.classList.add(targetClass);
				target.classList.add(targetClass);
			}

			window.dispatchEvent(new Event('resize'));
		};

		return new bootstrap.Tooltip(expandTogglerEl, {
			title: app.card.expand.toggleTitle,
			placement: 'bottom',
			trigger: 'hover',
			container: 'body'
		});
	});
};



/* 06. Handle Tooltip & Popover Activation
------------------------------------------------ */
var handelTooltipPopoverActivation = function() {
	"use strict";

	var tooltipTriggerList = [].slice.call(document.querySelectorAll('['+ app.bootstrap.tooltip.attr +']'))
	var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
		return new bootstrap.Tooltip(tooltipTriggerEl);
	});

	var popoverTriggerList = [].slice.call(document.querySelectorAll('['+ app.bootstrap.popover.attr +']'))
	var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
		return new bootstrap.Popover(popoverTriggerEl);
	});
};



/* 07. Handle Scroll to Top Button
------------------------------------------------ */
var handleScrollToTopButton = function() {
	"use strict";

	var elmTriggerList = [].slice.call(document.querySelectorAll('['+ app.scrollToTopBtn.toggleAttr +']'));

	document.onscroll = function() {
		var doc = document.documentElement;
		var totalScroll = (window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0);
		var elmList = elmTriggerList.map(function(elm) {
			if (totalScroll >= app.scrollToTopBtn.heightShow) {
				if (!elm.classList.contains(app.scrollToTopBtn.showClass)) {
					elm.classList.add(app.scrollToTopBtn.showClass);
				}
			} else {
				elm.classList.remove(app.scrollToTopBtn.showClass);
			}
		});

		var elm = document.querySelectorAll(app.id)[0];

		if (totalScroll > 0) {
			elm.classList.add(app.header.hasScrollClass);
		} else {
			elm.classList.remove(app.header.hasScrollClass);
		}
	}

	var elmList = elmTriggerList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();

			window.scrollTo({top: 0, behavior: 'smooth'});
		}
	});
};



/* 08. Handle hexToRgba
------------------------------------------------ */
var hexToRgba = function(hex, transparent = 1) {
	var c;
	if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)){
		c= hex.substring(1).split('');
		if(c.length== 3){
				c= [c[0], c[0], c[1], c[1], c[2], c[2]];
		}
		c= '0x'+c.join('');
		return 'rgba('+[(c>>16)&255, (c>>8)&255, c&255].join(',')+','+ transparent +')';
	}
  throw new Error('Bad Hex');
};



/* 09. Handle Scroll To
------------------------------------------------ */
var handleScrollTo = function() {
	var elmTriggerList = [].slice.call(document.querySelectorAll('['+ app.scrollTo.attr +']'));
	var elmList = elmTriggerList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();

			var targetAttr = (elm.getAttribute(app.scrollTo.target)) ? this.getAttribute(app.scrollTo.target) : this.getAttribute(app.scrollTo.linkTarget);
			var targetElm = document.querySelectorAll(targetAttr)[0];
			var targetHeader = document.querySelectorAll(app.header.id)[0];
			var targetHeight = targetHeader.offsetHeight;
			if (targetElm) {
				var targetTop = targetElm.offsetTop - targetHeight - 24;
				window.scrollTo({top: targetTop, behavior: 'smooth'});
			}
		}
	});
};



/* 10. Handle Toggle Class
------------------------------------------------ */
var handleToggleClass = function() {
	var elmList = [].slice.call(document.querySelectorAll('['+ app.toggleClass.toggleAttr +']'));

	elmList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();

			var targetToggleClass = this.getAttribute(app.toggleClass.toggleAttr);
			var targetDismissClass = this.getAttribute(app.dismissClass.toggleAttr);
			var targetToggleElm = document.querySelector(this.getAttribute(app.toggleClass.targetAttr));

			if (!targetDismissClass) {
				if (targetToggleElm.classList.contains(targetToggleClass)) {
					targetToggleElm.classList.remove(targetToggleClass);
				} else {
					targetToggleElm.classList.add(targetToggleClass);
				}
			} else {
				if (!targetToggleElm.classList.contains(targetToggleClass) && !targetToggleElm.classList.contains(targetDismissClass)) {
					if (targetToggleElm.classList.contains(targetToggleClass)) {
						targetToggleElm.classList.remove(targetToggleClass);
					} else {
						targetToggleElm.classList.add(targetToggleClass);
					}
				} else {
					if (targetToggleElm.classList.contains(targetToggleClass)) {
						targetToggleElm.classList.remove(targetToggleClass);
					} else {
						targetToggleElm.classList.add(targetToggleClass);
					}
					if (targetToggleElm.classList.contains(targetDismissClass)) {
						targetToggleElm.classList.remove(targetDismissClass);
					} else {
						targetToggleElm.classList.add(targetDismissClass);
					}
				}
			}
		}
	});
}



/* 11. Handle Theme Panel
------------------------------------------------ */
var handleThemePanel = function() {
	"use strict";

	// 12.1 Theme Panel - Toggle / Dismiss
	var elmList = [].slice.call(document.querySelectorAll('['+ app.themePanel.toggleAttr +']'));

	elmList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();

			var targetContainer = document.querySelector('.'+ app.themePanel.class);
			var targetExpand = false;

			if (targetContainer.classList.contains(app.themePanel.activeClass)) {
				targetContainer.classList.remove(app.themePanel.activeClass);
			} else {
				targetContainer.classList.add(app.themePanel.activeClass);
				targetExpand = true;
			}
			if (Cookies) {
				Cookies.set(app.themePanel.cookieName, targetExpand);
			}
		}
	});

	// 12.2 Theme Panel - Page Load Cookies
	if (Cookies) {
		var themePanelExpand = Cookies.get(app.themePanel.cookieName);

		if (themePanelExpand == 'true' || typeof themePanelExpand == 'undefined') {
			var elm = document.querySelector('['+ app.themePanel.toggleAttr +']');
			if (elm) {
				elm.click();
			}
		}
	}


	// 12.3 Theme Panel - Theme Selector
	var elmList = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']'));
	elmList.map(function(elm) {
		elm.onclick = function() {
			for (var x = 0; x < document.body.classList.length; x++) {
				var targetClass = document.body.classList[x];
				if (targetClass.search('theme-') > -1) {
					document.body.classList.remove(targetClass);
				}
			}

			var targetTheme = this.getAttribute(app.themePanel.theme.classAttr);
			var targetThemeList = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']'));

			if (targetTheme) {
				document.body.classList.add(targetTheme);
			}
			targetThemeList.map(function(targetElm) {
				if (targetElm.getAttribute(app.themePanel.theme.classAttr) != targetTheme) {
					targetElm.closest('.'+ app.themePanel.themeListItemCLass).classList.remove(app.themePanel.theme.activeClass);
				}
			});

			this.closest('.'+ app.themePanel.themeListItemCLass).classList.add(app.themePanel.theme.activeClass);

			if (Cookies) {
				Cookies.set(app.themePanel.theme.cookieName, targetTheme);
				app.color.theme = (getComputedStyle(document.body).getPropertyValue('--bs-theme')).trim();
				app.color.themeRgb = (getComputedStyle(document.body).getPropertyValue('--bs-theme-rgb')).trim();

				document.dispatchEvent(new Event('theme-reload'));
			}
		}
	});

	if (Cookies) {
		if (Cookies.get(app.themePanel.theme.cookieName)) {
			var targetElm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.theme.toggleAttr +']' + '['+ app.themePanel.theme.classAttr +'="'+ Cookies.get(app.themePanel.theme.cookieName) +'"]');

			if (targetElm) {
				targetElm.click();

				app.color.theme = (getComputedStyle(document.body).getPropertyValue('--bs-theme')).trim();
				app.color.themeRgb = (getComputedStyle(document.body).getPropertyValue('--bs-theme-rgb')).trim();

				document.dispatchEvent(new Event('theme-reload'));
			}
		}
	}


	// 12.4 Theme Panel - Background Selector
	var elmList = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.themeCover.toggleAttr +']'));
	elmList.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();

			var htmlElm = document.querySelector('html');
			var targetTheme = this.getAttribute(app.themePanel.themeCover.classAttr);
			for (var x = 0; x < document.documentElement.classList.length; x++) {
				var targetClass = document.documentElement.classList[x];
				if (targetClass.search('bg-cover-') > -1) {
					htmlElm.classList.remove(targetClass);
				}
			}

			if (targetTheme) {
				htmlElm.classList.add(targetTheme);
			}

			var targetCoverList = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.themeCover.toggleAttr +']'));
			targetCoverList.map(function(targetElm) {
				if (targetElm.getAttribute(app.themePanel.themeCover.toggleAttr) != targetTheme) {
					targetElm.closest('.'+ app.themePanel.themeCoverItemClass).classList.remove(app.themePanel.themeCover.activeClass);
				}
			});

			this.closest('.'+ app.themePanel.themeCoverItemClass).classList.add(app.themePanel.themeCover.activeClass);
			if (Cookies) {
				Cookies.set(app.themePanel.themeCover.cookieName, targetTheme);
			}
		};
	});

	if (Cookies) {
		if (Cookies.get(app.themePanel.themeCover.cookieName)) {
			var targetElm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.themeCover.toggleAttr +']' + '['+ app.themePanel.themeCover.classAttr +'="'+ Cookies.get(app.themePanel.themeCover.cookieName) +'"]');
			if (targetElm) {
				targetElm.click();
			}
		}
	}


	// 12.5 Theme Panel - Mode Selector
	var elms = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.themeMode.toggleAttr +']'));
	elms.map(function(elm) {
		elm.onclick = function(e) {
			e.preventDefault();

			var targetElm = this;
			var targetMode = (targetElm.getAttribute(app.themePanel.themeMode.valueAttr)) ? targetElm.getAttribute(app.themePanel.themeMode.valueAttr) : '';

			if (targetMode == 'dark') {
				document.querySelector('html').setAttribute(app.themePanel.themeMode.attr, targetMode);
			} else {
				document.querySelector('html').removeAttribute(app.themePanel.themeMode.attr);
			}
			if (Cookies) {
				Cookies.set(app.themePanel.themeMode.cookieName, targetMode);
			}
			targetElm.classList.add(app.themePanel.themeMode.activeClass);

			var elms2 = [].slice.call(document.querySelectorAll('.'+ app.themePanel.class +' ['+ app.themePanel.themeMode.toggleAttr +']'));
			elms2.map(function(elm2) {
				if (elm2 != targetElm) {
					elm2.classList.remove(app.themePanel.themeMode.activeClass);
				}
			});

			handleCssVariable();
			document.dispatchEvent(new CustomEvent('theme-reload'));
		}
	});

	if (Cookies) {
		if (Cookies.get(app.themePanel.themeMode.cookieName)) {
			var targetElm = document.querySelector('.'+ app.themePanel.class +' ['+ app.themePanel.themeMode.toggleAttr +']' + '['+ app.themePanel.themeMode.valueAttr +'="'+ Cookies.get(app.themePanel.themeMode.cookieName) +'"]');
			if (targetElm) {
				targetElm.click();
			}
		}
	}
};



/* 12. Handle CSS Variable
------------------------------------------------ */
var handleCssVariable = function() {
	var rootStyle = getComputedStyle(document.body);

	// font
	if (app.variableFontList && app.variablePrefix) {
		for (var i = 0; i < (app.variableFontList).length; i++) {
			app.font[app.variableFontList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableFontList[i]).trim();
		}
	}

	// color
	if (app.variableColorList && app.variablePrefix) {
		for (var i = 0; i < (app.variableColorList).length; i++) {
			app.color[app.variableColorList[i].replace(/-([a-z|0-9])/g, (match, letter) => letter.toUpperCase())] = rootStyle.getPropertyValue('--'+ app.variablePrefix + app.variableColorList[i]).trim();
		}
	}
};



/* 13. Application Controller
------------------------------------------------ */
var App = function () {
	"use strict";

	return {
		//main function
		init: function () {
			this.initComponent();
			this.initSidebar();
			this.initAppLoad();
		},
		initAppLoad: function() {
			document.querySelector('body').classList.add(app.init.class);
		},
		initSidebar: function() {
			handleSidebarMenu();
			handleSidebarScrollMemory();
		},
		initComponent: function() {
			handleScrollbar();
			handleScrollToTopButton();
			handleScrollTo();
			handleCardAction();
			handelTooltipPopoverActivation();
			handleToggleClass();
			handleThemePanel();
			handleCssVariable();
		},
		scrollTop: function() {
			window.scrollTo({top: 0, behavior: 'smooth'});
		}
	};
}();



/* 14. Initialise
------------------------------------------------ */
document.addEventListener('DOMContentLoaded', function() {
	App.init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5UZW1wbGF0ZSBOYW1lOiBIVUQgLSBSZXNwb25zaXZlIEJvb3RzdHJhcCA1IEFkbWluIFRlbXBsYXRlXG5WZXJzaW9uOiAyLjAuMFxuQXV0aG9yOiBTZWFuIE5ndVxuV2Vic2l0ZTogaHR0cDovL3d3dy5zZWFudGhlbWUuY29tL2h1ZC9cblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdEFQUFMgQ09OVEVOVCBUQUJMRVxuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0PCEtLSA9PT09PT09PSBHTE9CQUwgU0NSSVBUIFNFVFRJTkcgPT09PT09PT0gLS0+XG4gIDAxLiBHbG9iYWwgVmFyaWFibGVcbiAgMDIuIEhhbmRsZSBTY3JvbGxiYXJcbiAgMDMuIEhhbmRsZSBTaWRlYmFyIE1lbnVcbiAgMDQuIEhhbmRsZSBTaWRlYmFyIFNjcm9sbCBNZW1vcnlcbiAgMDUuIEhhbmRsZSBDYXJkIEFjdGlvblxuICAwNi4gSGFuZGxlIFRvb2x0aXAgJiBQb3BvdmVyIEFjdGl2YXRpb25cbiAgMDcuIEhhbmRsZSBTY3JvbGwgdG8gVG9wIEJ1dHRvblxuICAwOC4gSGFuZGxlIGhleFRvUmdiYVxuICAwOS4gSGFuZGxlIFNjcm9sbCBUb1xuICAxMC4gSGFuZGxlIFRvZ2dsZSBDbGFzc1xuICAxMS4gSGFuZGxlIFRoZW1lIFBhbmVsXG4gIDEyLiBIYW5kbGUgQ1NTIFZhcmlhYmxlXG4gIDEzLiBBcHBsaWNhdGlvbiBDb250cm9sbGVyXG4gIDE0LiBJbml0aWFsaXNlXG5cdFxuXHQ8IS0tID09PT09PT09IEFQUExJQ0FUSU9OIFNFVFRJTkcgPT09PT09PT0gLS0+XG5cdEFwcGxpY2F0aW9uIENvbnRyb2xsZXJcbiovXG5cblxuXG4vKiAwMS4gR2xvYmFsIFZhcmlhYmxlXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBhcHAgPSB7XG5cdGlkOiAnI2FwcCcsXG5cdGlzTW9iaWxlOiAoKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgfHwgd2luZG93LmlubmVyV2lkdGggPCA5OTIpLFxuXHRib290c3RyYXA6IHtcblx0XHR0b29sdGlwOiB7XG5cdFx0XHRhdHRyOiAnZGF0YS1icy10b2dnbGU9XCJ0b29sdGlwXCInXG5cdFx0fSxcblx0XHRwb3BvdmVyOiB7XG5cdFx0XHRhdHRyOiAnZGF0YS1icy10b2dnbGU9XCJwb3BvdmVyXCInXG5cdFx0fSxcblx0XHRtb2RhbDoge1xuXHRcdFx0YXR0cjogJ2RhdGEtYnMtdG9nZ2xlPVwibW9kYWxcIicsXG5cdFx0XHRkaXNtaXNzQXR0cjogJ2RhdGEtYnMtZGlzbWlzcz1cIm1vZGFsXCInLFxuXHRcdFx0ZXZlbnQ6IHtcblx0XHRcdFx0aGlkZGVuOiAnaGlkZGVuLmJzLm1vZGFsJ1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0bmF2OiB7XG5cdFx0XHRjbGFzczogJ25hdicsXG5cdFx0XHR0YWJzOiB7XG5cdFx0XHRcdGNsYXNzOiAnbmF2LXRhYnMnLFxuXHRcdFx0XHRhY3RpdmVDbGFzczogJ2FjdGl2ZScsXG5cdFx0XHRcdGl0ZW1DbGFzczogJ25hdi1pdGVtJyxcblx0XHRcdFx0aXRlbUxpbmtDbGFzczogJ25hdi1saW5rJ1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0aGVhZGVyOiB7XG5cdFx0aWQ6ICcjaGVhZGVyJyxcblx0XHRjbGFzczogJ2FwcC1oZWFkZXInLFxuXHRcdGhhc1Njcm9sbENsYXNzOiAnaGFzLXNjcm9sbCdcblx0fSxcblx0c2lkZWJhcjoge1xuXHRcdGlkOiAnI3NpZGViYXInLFxuXHRcdGNsYXNzOiAnYXBwLXNpZGViYXInLFxuXHRcdHNjcm9sbEJhcjoge1xuXHRcdFx0bG9jYWxTdG9yYWdlOiAnYXBwU2lkZWJhclNjcm9sbFBvc2l0aW9uJyxcblx0XHRcdGRvbTogJydcblx0XHR9LFxuXHRcdG1lbnU6IHtcblx0XHRcdGNsYXNzOiAnbWVudScsXG5cdFx0XHRpbml0QXR0cjogJ2RhdGEtaW5pdCcsXG5cdFx0XHRhbmltYXRpb25UaW1lOiAwLFxuXHRcdFx0aXRlbUNsYXNzOiAnbWVudS1pdGVtJyxcblx0XHRcdGl0ZW1MaW5rQ2xhc3M6ICdtZW51LWxpbmsnLFxuXHRcdFx0aGFzU3ViQ2xhc3M6ICdoYXMtc3ViJyxcblx0XHRcdGFjdGl2ZUNsYXNzOiAnYWN0aXZlJyxcblx0XHRcdGV4cGFuZGluZ0NsYXNzOiAnZXhwYW5kaW5nJyxcblx0XHRcdGV4cGFuZENsYXNzOiAnZXhwYW5kJyxcblx0XHRcdHN1Ym1lbnU6IHtcblx0XHRcdFx0Y2xhc3M6ICdtZW51LXN1Ym1lbnUnLFxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0bW9iaWxlOiB7XG5cdFx0XHR0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJhcHAtc2lkZWJhci1tb2JpbGVcIicsXG5cdFx0XHRkaXNtaXNzQXR0cjogJ2RhdGEtZGlzbWlzcz1cImFwcC1zaWRlYmFyLW1vYmlsZVwiJyxcblx0XHRcdHRvZ2dsZWRDbGFzczogJ2FwcC1zaWRlYmFyLW1vYmlsZS10b2dnbGVkJyxcblx0XHRcdGNsb3NlZENsYXNzOiAnYXBwLXNpZGViYXItbW9iaWxlLWNsb3NlZCcsXG5cdFx0XHRiYWNrZHJvcDoge1xuXHRcdFx0XHRjbGFzczogJ2FwcC1zaWRlYmFyLW1vYmlsZS1iYWNrZHJvcCdcblx0XHRcdH1cblx0XHR9LFxuXHRcdG1pbmlmeToge1xuXHRcdFx0dG9nZ2xlQXR0cjogJ2RhdGEtdG9nZ2xlPVwiYXBwLXNpZGViYXItbWluaWZ5XCInLFxuXHRcdFx0dG9nZ2xlZENsYXNzOiAnYXBwLXNpZGViYXItbWluaWZpZWQnLFxuXHRcdFx0Y29va2llTmFtZTogJ2FwcC1zaWRlYmFyLW1pbmlmaWVkJ1xuXHRcdH0sXG5cdFx0ZmxvYXRTdWJtZW51OiB7XG5cdFx0XHRpZDogJyNhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51Jyxcblx0XHRcdGRvbTogJycsXG5cdFx0XHR0aW1lb3V0OiAnJyxcblx0XHRcdGNsYXNzOiAnYXBwLXNpZGViYXItZmxvYXQtc3VibWVudScsXG5cdFx0XHRjb250YWluZXI6IHtcblx0XHRcdFx0Y2xhc3M6ICdhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51LWNvbnRhaW5lcidcblx0XHRcdH0sXG5cdFx0XHRhcnJvdzoge1xuXHRcdFx0XHRpZDogJyNhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51LWFycm93Jyxcblx0XHRcdFx0Y2xhc3M6ICdhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51LWFycm93J1xuXHRcdFx0fSxcblx0XHRcdGxpbmU6IHtcblx0XHRcdFx0aWQ6ICcjYXBwLXNpZGViYXItZmxvYXQtc3VibWVudS1saW5lJyxcblx0XHRcdFx0Y2xhc3M6ICdhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51LWxpbmUnXG5cdFx0XHR9LFxuXHRcdFx0b3ZlcmZsb3c6IHtcblx0XHRcdFx0Y2xhc3M6ICdvdmVyZmxvdy1zY3JvbGwgbWgtMTAwdmgnXG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzZWFyY2g6IHtcblx0XHRcdGNsYXNzOiAnbWVudS1zZWFyY2gnLFxuXHRcdFx0dG9nZ2xlQXR0cjogJ2RhdGEtc2lkZWJhci1zZWFyY2g9XCJ0cnVlXCInLFxuXHRcdFx0aGlkZUNsYXNzOiAnZC1ub25lJyxcblx0XHRcdGZvdW5kQ2xhc3M6ICdoYXMtdGV4dCdcblx0XHR9LFxuXHRcdHRyYW5zcGFyZW50OiB7XG5cdFx0XHRjbGFzczogJ2FwcC1zaWRlYmFyLXRyYW5zcGFyZW50J1xuXHRcdH1cblx0fSxcblx0c2Nyb2xsQmFyOiB7XG5cdFx0YXR0cjogJ2RhdGEtc2Nyb2xsYmFyPVwidHJ1ZVwiJyxcblx0XHRza2lwTW9iaWxlQXR0cjogJ2RhdGEtc2tpcC1tb2JpbGUnLFxuXHRcdGhlaWdodEF0dHI6ICdkYXRhLWhlaWdodCcsXG5cdFx0d2hlZWxQcm9wYWdhdGlvbkF0dHI6ICdkYXRhLXdoZWVsLXByb3BhZ2F0aW9uJ1xuXHR9LFxuXHRjb250ZW50OiB7XG5cdFx0aWQ6ICcjY29udGVudCcsXG5cdFx0Y2xhc3M6ICdhcHAtY29udGVudCcsXG5cdFx0ZnVsbEhlaWdodDoge1xuXHRcdFx0Y2xhc3M6ICdhcHAtY29udGVudC1mdWxsLWhlaWdodCdcblx0XHR9LFxuXHRcdGZ1bGxXaWR0aDoge1xuXHRcdFx0Y2xhc3M6ICdhcHAtY29udGVudC1mdWxsLXdpZHRoJ1xuXHRcdH1cblx0fSxcblx0bGF5b3V0OiB7XG5cdFx0c2lkZWJhckxpZ2h0OiB7XG5cdFx0XHRjbGFzczogJ2FwcC13aXRoLWxpZ2h0LXNpZGViYXInXG5cdFx0fSxcblx0XHRzaWRlYmFyRW5kOiB7XG5cdFx0XHRjbGFzczogJ2FwcC13aXRoLWVuZC1zaWRlYmFyJ1xuXHRcdH0sXG5cdFx0c2lkZWJhcldpZGU6IHtcblx0XHRcdGNsYXNzOiAnYXBwLXdpdGgtd2lkZS1zaWRlYmFyJ1xuXHRcdH0sXG5cdFx0c2lkZWJhck1pbmlmaWVkOiB7XG5cdFx0XHRjbGFzczogJ2FwcC1zaWRlYmFyLW1pbmlmaWVkJ1xuXHRcdH0sXG5cdFx0c2lkZWJhclR3bzoge1xuXHRcdFx0Y2xhc3M6ICdhcHAtd2l0aC10d28tc2lkZWJhcidcblx0XHR9LFxuXHRcdHdpdGhvdXRIZWFkZXI6IHtcblx0XHRcdGNsYXNzOiAnYXBwLXdpdGhvdXQtaGVhZGVyJ1xuXHRcdH0sXG5cdFx0d2l0aG91dFNpZGViYXI6IHtcblx0XHRcdGNsYXNzOiAnYXBwLXdpdGhvdXQtc2lkZWJhcidcblx0XHR9LFxuXHRcdHRvcE1lbnU6IHtcblx0XHRcdGNsYXNzOiAnYXBwLXdpdGgtdG9wLW1lbnUnXG5cdFx0fSxcblx0XHRib3hlZExheW91dDoge1xuXHRcdFx0Y2xhc3M6ICdib3hlZC1sYXlvdXQnXG5cdFx0fVxuXHR9LFxuXHRzY3JvbGxUb1RvcEJ0bjoge1xuXHRcdHNob3dDbGFzczogJ3Nob3cnLFxuXHRcdGhlaWdodFNob3c6IDIwMCxcblx0XHR0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJzY3JvbGwtdG8tdG9wXCInLFxuXHRcdHNjcm9sbFNwZWVkOiA1MDBcblx0fSxcblx0c2Nyb2xsVG86IHtcblx0XHRhdHRyOiAnZGF0YS10b2dnbGU9XCJzY3JvbGwtdG9cIicsXG5cdFx0dGFyZ2V0OiAnZGF0YS10YXJnZXQnLFxuXHRcdGxpbmtUYXJnZXQ6ICdocmVmJ1xuXHR9LFxuXHR0aGVtZVBhbmVsOiB7XG5cdFx0Y2xhc3M6ICdhcHAtdGhlbWUtcGFuZWwnLFxuXHRcdHRvZ2dsZUF0dHI6ICdkYXRhLXRvZ2dsZT1cInRoZW1lLXBhbmVsLWV4cGFuZFwiJyxcblx0XHRjb29raWVOYW1lOiAnYXBwLXRoZW1lLXBhbmVsLWV4cGFuZCcsXG5cdFx0YWN0aXZlQ2xhc3M6ICdhY3RpdmUnLFxuXHRcdHRoZW1lTGlzdENMYXNzOiAnYXBwLXRoZW1lLWxpc3QnLFxuXHRcdHRoZW1lTGlzdEl0ZW1DTGFzczogJ2FwcC10aGVtZS1saXN0LWl0ZW0nLFxuXHRcdHRoZW1lQ292ZXJDbGFzczogJ2FwcC10aGVtZS1jb3ZlcicsXG5cdFx0dGhlbWVDb3Zlckl0ZW1DbGFzczogJ2FwcC10aGVtZS1jb3Zlci1pdGVtJyxcblx0XHR0aGVtZToge1xuXHRcdFx0dG9nZ2xlQXR0cjogJ2RhdGEtdG9nZ2xlPVwidGhlbWUtc2VsZWN0b3JcIicsXG5cdFx0XHRjbGFzc0F0dHI6ICdkYXRhLXRoZW1lLWNsYXNzJyxcblx0XHRcdGNvb2tpZU5hbWU6ICdhcHAtdGhlbWUnLFxuXHRcdFx0YWN0aXZlQ2xhc3M6ICdhY3RpdmUnXG5cdFx0fSxcblx0XHR0aGVtZUNvdmVyOiB7XG5cdFx0XHR0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJ0aGVtZS1jb3Zlci1zZWxlY3RvclwiJyxcblx0XHRcdGNsYXNzQXR0cjogJ2RhdGEtdGhlbWUtY292ZXItY2xhc3MnLFxuXHRcdFx0Y29va2llTmFtZTogJ2FwcC10aGVtZS1jb3ZlcicsXG5cdFx0XHRhY3RpdmVDbGFzczogJ2FjdGl2ZSdcblx0XHR9LFxuXHRcdHRoZW1lTW9kZToge1xuXHRcdFx0dG9nZ2xlQXR0cjogJ2RhdGEtdG9nZ2xlPVwidGhlbWUtbW9kZS1zZWxlY3RvclwiJyxcblx0XHRcdHZhbHVlQXR0cjogJ2RhdGEtdGhlbWUtbW9kZScsXG5cdFx0XHRjb29raWVOYW1lOiAnYXBwLXRoZW1lLW1vZGUnLFxuXHRcdFx0YWN0aXZlQ2xhc3M6ICdhY3RpdmUnLFxuXHRcdFx0YXR0cjogJ2RhdGEtYnMtdGhlbWUnXG5cdFx0fVxuXHR9LFxuXHRkaXNtaXNzQ2xhc3M6IHtcblx0XHR0b2dnbGVBdHRyOiAnZGF0YS1kaXNtaXNzLWNsYXNzJyxcblx0XHR0YXJnZXRBdHRyOiAnZGF0YS1kaXNtaXNzLXRhcmdldCdcblx0fSxcblx0dG9nZ2xlQ2xhc3M6IHtcblx0XHR0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGUtY2xhc3MnLFxuXHRcdHRhcmdldEF0dHI6ICdkYXRhLXRvZ2dsZS10YXJnZXQnXG5cdH0sXG5cdHZhcmlhYmxlUHJlZml4OiAnYnMtJyxcblx0dmFyaWFibGVGb250TGlzdDogWydib2R5LWZvbnQtZmFtaWx5JywgJ2JvZHktZm9udC1zaXplJywgJ2JvZHktZm9udC13ZWlnaHQnLCAnYm9keS1saW5lLWhlaWdodCddLFxuXHR2YXJpYWJsZUNvbG9yTGlzdDogW1xuXHRcdCd0aGVtZScsICd0aGVtZS1yZ2InLCAndGhlbWUtY29sb3InLCAndGhlbWUtY29sb3ItcmdiJyxcblx0XHQnZGVmYXVsdCcsICdkZWZhdWx0LXJnYicsXG5cdFx0J3ByaW1hcnknLCAncHJpbWFyeS1yZ2InLCAncHJpbWFyeS1iZy1zdWJ0bGUnLCAncHJpbWFyeS10ZXh0JywgJ3ByaW1hcnktYm9yZGVyLXN1YnRsZScsXG5cdFx0J3NlY29uZGFyeScsICdzZWNvbmRhcnktcmdiJywgJ3NlY29uZGFyeS1iZy1zdWJ0bGUnLCAnc2Vjb25kYXJ5LXRleHQnLCAnc2Vjb25kYXJ5LWJvcmRlci1zdWJ0bGUnLFxuXHRcdCdzdWNjZXNzJywgJ3N1Y2Nlc3MtcmdiJywgJ3N1Y2Nlc3MtYmctc3VidGxlJywgJ3N1Y2Nlc3MtdGV4dCcsICdzdWNjZXNzLWJvcmRlci1zdWJ0bGUnLFxuXHRcdCd3YXJuaW5nJywgJ3dhcm5pbmctcmdiJywgJ3dhcm5pbmctYmctc3VidGxlJywgJ3dhcm5pbmctdGV4dCcsICd3YXJuaW5nLWJvcmRlci1zdWJ0bGUnLFxuXHRcdCdpbmZvJywgJ2luZm8tcmdiJywgJ2luZm8tYmctc3VidGxlJywgJ2luZm8tdGV4dCcsICdpbmZvLWJvcmRlci1zdWJ0bGUnLFxuXHRcdCdkYW5nZXInLCAnZGFuZ2VyLXJnYicsICdkYW5nZXItYmctc3VidGxlJywgJ2Rhbmdlci10ZXh0JywgJ2Rhbmdlci1ib3JkZXItc3VidGxlJyxcblx0XHQnbGlnaHQnLCAnbGlnaHQtcmdiJywgJ2xpZ2h0LWJnLXN1YnRsZScsICdsaWdodC10ZXh0JywgJ2xpZ2h0LWJvcmRlci1zdWJ0bGUnLFxuXHRcdCdkYXJrJywgJ2RhcmstcmdiJywgJ2RhcmstYmctc3VidGxlJywgJ2RhcmstdGV4dCcsICdkYXJrLWJvcmRlci1zdWJ0bGUnLFxuXHRcdCdpbnZlcnNlJywgJ2ludmVyc2UtcmdiJyxcblx0XHQnd2hpdGUnLCAnd2hpdGUtcmdiJyxcblx0XHQnYmxhY2snLCAnYmxhY2stcmdiJyxcblx0XHQndGVhbCcsICd0ZWFsLXJnYicsXG5cdFx0J2luZGlnbycsICdpbmRpZ28tcmdiJywgXG5cdFx0J3B1cnBsZScsICdwdXJwbGUtcmdiJyxcblx0XHQneWVsbG93JywgJ3llbGxvdy1yZ2InLFxuXHRcdCdwaW5rJywgJ3BpbmstcmdiJyxcblx0XHQnY3lhbicsICdjeWFuLXJnYicsXG5cdFx0J2dyYXktMTAwJywgJ2dyYXktMjAwJywgJ2dyYXktMzAwJywgJ2dyYXktNDAwJywgJ2dyYXktNTAwJywgICdncmF5LTYwMCcsICdncmF5LTcwMCcsICdncmF5LTgwMCcsICdncmF5LTkwMCcsIFxuXHRcdCdncmF5LTEwMC1yZ2InLCAnZ3JheS0yMDAtcmdiJywgJ2dyYXktMzAwLXJnYicsICdncmF5LTQwMC1yZ2InLCAnZ3JheS01MDAtcmdiJywgICdncmF5LTYwMC1yZ2InLCAnZ3JheS03MDAtcmdiJywgJ2dyYXktODAwLXJnYicsICdncmF5LTkwMC1yZ2InLCBcblx0XHQnbXV0ZWQnLCAnbXV0ZWQtcmdiJywgJ2VtcGhhc2lzLWNvbG9yJywgJ2VtcGhhc2lzLWNvbG9yLXJnYicsXG5cdFx0J2JvZHktYmcnLCAnYm9keS1iZy1yZ2InLCAnYm9keS1jb2xvcicsICdib2R5LWNvbG9yLXJnYicsXG5cdFx0J2hlYWRpbmctY29sb3InLCBcblx0XHQnc2Vjb25kYXJ5LWNvbG9yJywgJ3NlY29uZGFyeS1jb2xvci1yZ2InLCAnc2Vjb25kYXJ5LWJnJywgJ3NlY29uZGFyeS1iZy1yZ2InLFxuXHRcdCd0ZXJ0aWFyeS1jb2xvcicsICd0ZXJ0aWFyeS1jb2xvci1yZ2InLCAndGVydGlhcnktYmcnLCAndGVydGlhcnktYmctcmdiJyxcblx0XHQnbGluay1jb2xvcicsICdsaW5rLWNvbG9yLXJnYicsICdsaW5rLWhvdmVyLWNvbG9yJywgJ2xpbmstaG92ZXItY29sb3ItcmdiJywgXG5cdFx0J2JvcmRlci1jb2xvcicsICdib3JkZXItY29sb3ItdHJhbnNsdWNlbnQnXG5cdF0sXG5cdGZvbnQ6IHt9LFxuXHRjb2xvcjoge30sXG5cdGNhcmQ6IHtcblx0XHRleHBhbmQ6IHtcblx0XHRcdHN0YXR1czogZmFsc2UsXG5cdFx0XHR0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJjYXJkLWV4cGFuZFwiJyxcblx0XHRcdHRvZ2dsZVRpdGxlOiAnRXhwYW5kIC8gQ29tcHJlc3MnLFxuXHRcdFx0Y2xhc3M6ICdjYXJkLWV4cGFuZCdcblx0XHR9XG5cdH0sXG5cdGluaXQ6IHtcblx0XHRhdHRyOiAnZGF0YS1pbml0Jyxcblx0XHRjbGFzczogJ2FwcC1pbml0J1xuXHR9XG59O1xuXG5cblxuLyogMDIuIEhhbmRsZSBTY3JvbGxiYXJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVNjcm9sbGJhciA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIGVsbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbJysgYXBwLnNjcm9sbEJhci5hdHRyICsnXScpO1xuXHRcdFxuXHRmb3IgKHZhciBpID0gMDsgaSA8IGVsbXMubGVuZ3RoOyBpKyspIHtcblx0XHRnZW5lcmF0ZVNjcm9sbGJhcihlbG1zW2ldKVxuXHR9XG59O1xudmFyIGdlbmVyYXRlU2Nyb2xsYmFyID0gZnVuY3Rpb24oZWxtKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXHRcblx0aWYgKGVsbS5zY3JvbGxiYXJJbml0IHx8IChhcHAuaXNNb2JpbGUgJiYgZWxtLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsQmFyLnNraXBNb2JpbGVBdHRyKSkpIHtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIGRhdGFIZWlnaHQgPSAoIWVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci5oZWlnaHRBdHRyKSkgPyBlbG0ub2Zmc2V0SGVpZ2h0IDogZWxtLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsQmFyLmhlaWdodEF0dHIpO1xuXHRcblx0ZWxtLnN0eWxlLmhlaWdodCA9IGRhdGFIZWlnaHQ7XG5cdGVsbS5zY3JvbGxiYXJJbml0ID0gdHJ1ZTtcblx0XG5cdGlmKGFwcC5pc01vYmlsZSkge1xuXHRcdGVsbS5zdHlsZS5vdmVyZmxvd1ggPSAnc2Nyb2xsJztcblx0fSBlbHNlIHtcblx0XHR2YXIgZGF0YVdoZWVsUHJvcGFnYXRpb24gPSAoZWxtLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsQmFyLndoZWVsUHJvcGFnYXRpb25BdHRyKSkgPyBlbG0uZ2V0QXR0cmlidXRlKGFwcC5zY3JvbGxCYXIud2hlZWxQcm9wYWdhdGlvbkF0dHIpIDogZmFsc2U7XG5cdFx0XG5cdFx0aWYgKGVsbS5jbG9zZXN0KCcuJysgYXBwLnNpZGViYXIuY2xhc3MpICYmIGVsbS5jbG9zZXN0KCcuJysgYXBwLnNpZGViYXIuY2xhc3MpLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0YXBwLnNpZGViYXIuc2Nyb2xsQmFyLmRvbSA9IG5ldyBQZXJmZWN0U2Nyb2xsYmFyKGVsbSwge1xuXHRcdFx0XHR3aGVlbFByb3BhZ2F0aW9uOiBkYXRhV2hlZWxQcm9wYWdhdGlvblxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG5ldyBQZXJmZWN0U2Nyb2xsYmFyKGVsbSwge1xuXHRcdFx0XHR3aGVlbFByb3BhZ2F0aW9uOiBkYXRhV2hlZWxQcm9wYWdhdGlvblxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdGVsbS5zZXRBdHRyaWJ1dGUoYXBwLmluaXQuYXR0ciwgdHJ1ZSk7XG5cdGVsbS5jbGFzc0xpc3QucmVtb3ZlKCdpbnZpc2libGUnKTtcbn07XG5cblxuXG4vKiAwMy4gSGFuZGxlIFNpZGViYXIgTWVudVxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlU2lkZWJhck1lbnVUb2dnbGUgPSBmdW5jdGlvbihtZW51cykge1xuXHRtZW51cy5tYXAoZnVuY3Rpb24obWVudSkge1xuXHRcdG1lbnUub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHZhciB0YXJnZXQgPSB0aGlzLm5leHRFbGVtZW50U2libGluZztcblx0XG5cdFx0XHRtZW51cy5tYXAoZnVuY3Rpb24obSkge1xuXHRcdFx0XHR2YXIgb3RoZXJUYXJnZXQgPSBtLm5leHRFbGVtZW50U2libGluZztcblx0XHRcdFx0aWYgKG90aGVyVGFyZ2V0ICE9PSB0YXJnZXQpIHtcblx0XHRcdFx0XHRvdGhlclRhcmdldC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdG90aGVyVGFyZ2V0LmNsb3Nlc3QoJy4nKyBhcHAuc2lkZWJhci5tZW51Lml0ZW1DbGFzcykuY2xhc3NMaXN0LnJlbW92ZShhcHAuc2lkZWJhci5tZW51LmV4cGFuZENsYXNzKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFxuXHRcdFx0dmFyIHRhcmdldEl0ZW1FbG0gPSB0YXJnZXQuY2xvc2VzdCgnLicrIGFwcC5zaWRlYmFyLm1lbnUuaXRlbUNsYXNzKTtcblxuXHRcdFx0aWYgKHRhcmdldEl0ZW1FbG0uY2xhc3NMaXN0LmNvbnRhaW5zKGFwcC5zaWRlYmFyLm1lbnUuZXhwYW5kQ2xhc3MpIHx8ICh0YXJnZXRJdGVtRWxtLmNsYXNzTGlzdC5jb250YWlucyhhcHAuc2lkZWJhci5tZW51LmFjdGl2ZUNsYXNzKSAmJiAhdGFyZ2V0LnN0eWxlLmRpc3BsYXkpKSB7XG5cdFx0XHRcdHRhcmdldEl0ZW1FbG0uY2xhc3NMaXN0LnJlbW92ZShhcHAuc2lkZWJhci5tZW51LmV4cGFuZENsYXNzKTtcblx0XHRcdFx0dGFyZ2V0LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0YXJnZXRJdGVtRWxtLmNsYXNzTGlzdC5hZGQoYXBwLnNpZGViYXIubWVudS5leHBhbmRDbGFzcyk7XG5cdFx0XHRcdHRhcmdldC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufTtcbnZhciBoYW5kbGVTaWRlYmFyTWVudSA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdHZhciBtZW51QmFzZVNlbGVjdG9yID0gJy4nKyBhcHAuc2lkZWJhci5jbGFzcyArJyAuJysgYXBwLnNpZGViYXIubWVudS5jbGFzcyArJyA+IC4nKyBhcHAuc2lkZWJhci5tZW51Lml0ZW1DbGFzcyArJy4nKyBhcHAuc2lkZWJhci5tZW51Lmhhc1N1YkNsYXNzO1xuXHR2YXIgc3VibWVudUJhc2VTZWxlY3RvciA9ICcgPiAuJysgYXBwLnNpZGViYXIubWVudS5zdWJtZW51LmNsYXNzICsnID4gLicrIGFwcC5zaWRlYmFyLm1lbnUuaXRlbUNsYXNzICsgJy4nICsgYXBwLnNpZGViYXIubWVudS5oYXNTdWJDbGFzcztcblx0XG5cdC8vIG1lbnVcblx0dmFyIG1lbnVMaW5rU2VsZWN0b3IgPSAgbWVudUJhc2VTZWxlY3RvciArICcgPiAuJysgYXBwLnNpZGViYXIubWVudS5pdGVtTGlua0NsYXNzO1xuXHR2YXIgbWVudXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwobWVudUxpbmtTZWxlY3RvcikpO1xuXHRoYW5kbGVTaWRlYmFyTWVudVRvZ2dsZShtZW51cyk7XG5cdFxuXHQvLyBzdWJtZW51IGx2bCAxXG5cdHZhciBzdWJtZW51THZsMVNlbGVjdG9yID0gbWVudUJhc2VTZWxlY3RvciArIHN1Ym1lbnVCYXNlU2VsZWN0b3I7XG5cdHZhciBzdWJtZW51c0x2bDEgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc3VibWVudUx2bDFTZWxlY3RvciArICcgPiAuJyArIGFwcC5zaWRlYmFyLm1lbnUuaXRlbUxpbmtDbGFzcykpO1xuXHRoYW5kbGVTaWRlYmFyTWVudVRvZ2dsZShzdWJtZW51c0x2bDEpO1xuXHRcblx0Ly8gc3VibWVudSBsdmwgMlxuXHR2YXIgc3VibWVudUx2bDJTZWxlY3RvciA9IG1lbnVCYXNlU2VsZWN0b3IgKyBzdWJtZW51QmFzZVNlbGVjdG9yICsgc3VibWVudUJhc2VTZWxlY3Rvcjtcblx0dmFyIHN1Ym1lbnVzTHZsMiA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzdWJtZW51THZsMlNlbGVjdG9yICsgJyA+IC4nICsgYXBwLnNpZGViYXIubWVudS5pdGVtTGlua0NsYXNzKSk7XG5cdGhhbmRsZVNpZGViYXJNZW51VG9nZ2xlKHN1Ym1lbnVzTHZsMik7XG59O1xuXG5cblxuLyogMDQuIEhhbmRsZSBTaWRlYmFyIFNjcm9sbCBNZW1vcnlcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVNpZGViYXJTY3JvbGxNZW1vcnkgPSBmdW5jdGlvbigpIHtcblx0aWYgKCFhcHAuaXNNb2JpbGUpIHtcblx0XHR0cnkge1xuXHRcdFx0aWYgKHR5cGVvZihTdG9yYWdlKSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mKGxvY2FsU3RvcmFnZSkgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdHZhciBlbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLnNpZGViYXIuY2xhc3MgKycgWycrIGFwcC5zY3JvbGxCYXIuYXR0ciArJ10nKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChlbG0pIHtcblx0XHRcdFx0XHRlbG0ub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKGFwcC5zaWRlYmFyLnNjcm9sbEJhci5sb2NhbFN0b3JhZ2UsIHRoaXMuc2Nyb2xsVG9wKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dmFyIGRlZmF1bHRTY3JvbGwgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShhcHAuc2lkZWJhci5zY3JvbGxCYXIubG9jYWxTdG9yYWdlKTtcblx0XHRcdFx0XHRpZiAoZGVmYXVsdFNjcm9sbCkge1xuXHRcdFx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC5zaWRlYmFyLmNsYXNzICsnIFsnKyBhcHAuc2Nyb2xsQmFyLmF0dHIgKyddJykuc2Nyb2xsVG9wID0gZGVmYXVsdFNjcm9sbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5sb2coZXJyb3IpO1xuXHRcdH1cblx0fVxufTtcblxuXG5cbi8qIDA1LiBIYW5kbGUgQ2FyZCBBY3Rpb25cbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZUNhcmRBY3Rpb24gPSBmdW5jdGlvbigpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0aWYgKGFwcC5jYXJkLmV4cGFuZC5zdGF0dXMpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0YXBwLmNhcmQuZXhwYW5kLnN0YXR1cyA9IHRydWU7XG5cblx0Ly8gZXhwYW5kXG5cdHZhciBleHBhbmRUb2dnbGVyTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnWycrIGFwcC5jYXJkLmV4cGFuZC50b2dnbGVBdHRyICsnXScpKTtcblx0dmFyIGV4cGFuZFRvZ2dsZXJUb29sdGlwTGlzdCA9IGV4cGFuZFRvZ2dsZXJMaXN0Lm1hcChmdW5jdGlvbiAoZXhwYW5kVG9nZ2xlckVsKSB7XG5cdFx0ZXhwYW5kVG9nZ2xlckVsLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XG5cdFx0XHR2YXIgdGFyZ2V0ID0gdGhpcy5jbG9zZXN0KCcuY2FyZCcpO1xuXHRcdFx0dmFyIHRhcmdldENsYXNzID0gYXBwLmNhcmQuZXhwYW5kLmNsYXNzO1xuXHRcdFx0dmFyIHRhcmdldFRvcCA9IDQwO1xuXG5cdFx0XHRpZiAoZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0Q2xhc3MpICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0Q2xhc3MpKSB7XG5cdFx0XHRcdHRhcmdldC5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XG5cdFx0XHRcdHRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldENsYXNzKTtcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldENsYXNzKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCh0YXJnZXRDbGFzcyk7XG5cdFx0XHRcdHRhcmdldC5jbGFzc0xpc3QuYWRkKHRhcmdldENsYXNzKTtcblx0XHRcdH1cblx0XHRcblx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgncmVzaXplJykpO1xuXHRcdH07XG5cdFxuXHRcdHJldHVybiBuZXcgYm9vdHN0cmFwLlRvb2x0aXAoZXhwYW5kVG9nZ2xlckVsLCB7XG5cdFx0XHR0aXRsZTogYXBwLmNhcmQuZXhwYW5kLnRvZ2dsZVRpdGxlLFxuXHRcdFx0cGxhY2VtZW50OiAnYm90dG9tJyxcblx0XHRcdHRyaWdnZXI6ICdob3ZlcicsXG5cdFx0XHRjb250YWluZXI6ICdib2R5J1xuXHRcdH0pO1xuXHR9KTtcbn07XG5cblxuXG4vKiAwNi4gSGFuZGxlIFRvb2x0aXAgJiBQb3BvdmVyIEFjdGl2YXRpb25cbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRlbFRvb2x0aXBQb3BvdmVyQWN0aXZhdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdHZhciB0b29sdGlwVHJpZ2dlckxpc3QgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1snKyBhcHAuYm9vdHN0cmFwLnRvb2x0aXAuYXR0ciArJ10nKSlcblx0dmFyIHRvb2x0aXBMaXN0ID0gdG9vbHRpcFRyaWdnZXJMaXN0Lm1hcChmdW5jdGlvbiAodG9vbHRpcFRyaWdnZXJFbCkge1xuXHRcdHJldHVybiBuZXcgYm9vdHN0cmFwLlRvb2x0aXAodG9vbHRpcFRyaWdnZXJFbCk7XG5cdH0pO1xuXHRcblx0dmFyIHBvcG92ZXJUcmlnZ2VyTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnWycrIGFwcC5ib290c3RyYXAucG9wb3Zlci5hdHRyICsnXScpKVxuXHR2YXIgcG9wb3Zlckxpc3QgPSBwb3BvdmVyVHJpZ2dlckxpc3QubWFwKGZ1bmN0aW9uIChwb3BvdmVyVHJpZ2dlckVsKSB7XG5cdFx0cmV0dXJuIG5ldyBib290c3RyYXAuUG9wb3Zlcihwb3BvdmVyVHJpZ2dlckVsKTtcblx0fSk7XG59O1xuXG5cblxuLyogMDcuIEhhbmRsZSBTY3JvbGwgdG8gVG9wIEJ1dHRvblxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlU2Nyb2xsVG9Ub3BCdXR0b24gPSBmdW5jdGlvbigpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHR2YXIgZWxtVHJpZ2dlckxpc3QgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1snKyBhcHAuc2Nyb2xsVG9Ub3BCdG4udG9nZ2xlQXR0ciArJ10nKSk7XG5cdFxuXHRkb2N1bWVudC5vbnNjcm9sbCA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBkb2MgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cdFx0dmFyIHRvdGFsU2Nyb2xsID0gKHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2Muc2Nyb2xsVG9wKSAgLSAoZG9jLmNsaWVudFRvcCB8fCAwKTtcblx0XHR2YXIgZWxtTGlzdCA9IGVsbVRyaWdnZXJMaXN0Lm1hcChmdW5jdGlvbihlbG0pIHtcblx0XHRcdGlmICh0b3RhbFNjcm9sbCA+PSBhcHAuc2Nyb2xsVG9Ub3BCdG4uaGVpZ2h0U2hvdykge1xuXHRcdFx0XHRpZiAoIWVsbS5jbGFzc0xpc3QuY29udGFpbnMoYXBwLnNjcm9sbFRvVG9wQnRuLnNob3dDbGFzcykpIHtcblx0XHRcdFx0XHRlbG0uY2xhc3NMaXN0LmFkZChhcHAuc2Nyb2xsVG9Ub3BCdG4uc2hvd0NsYXNzKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxtLmNsYXNzTGlzdC5yZW1vdmUoYXBwLnNjcm9sbFRvVG9wQnRuLnNob3dDbGFzcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0XG5cdFx0dmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYXBwLmlkKVswXTtcblx0XG5cdFx0aWYgKHRvdGFsU2Nyb2xsID4gMCkge1xuXHRcdFx0ZWxtLmNsYXNzTGlzdC5hZGQoYXBwLmhlYWRlci5oYXNTY3JvbGxDbGFzcyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsbS5jbGFzc0xpc3QucmVtb3ZlKGFwcC5oZWFkZXIuaGFzU2Nyb2xsQ2xhc3MpO1xuXHRcdH1cblx0fVxuXHRcblx0dmFyIGVsbUxpc3QgPSBlbG1UcmlnZ2VyTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XG5cdFx0ZWxtLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcblx0XHRcdHdpbmRvdy5zY3JvbGxUbyh7dG9wOiAwLCBiZWhhdmlvcjogJ3Ntb290aCd9KTtcblx0XHR9XG5cdH0pO1xufTtcblxuXG5cbi8qIDA4LiBIYW5kbGUgaGV4VG9SZ2JhXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoZXhUb1JnYmEgPSBmdW5jdGlvbihoZXgsIHRyYW5zcGFyZW50ID0gMSkge1xuXHR2YXIgYztcblx0aWYoL14jKFtBLUZhLWYwLTldezN9KXsxLDJ9JC8udGVzdChoZXgpKXtcblx0XHRjPSBoZXguc3Vic3RyaW5nKDEpLnNwbGl0KCcnKTtcblx0XHRpZihjLmxlbmd0aD09IDMpe1xuXHRcdFx0XHRjPSBbY1swXSwgY1swXSwgY1sxXSwgY1sxXSwgY1syXSwgY1syXV07XG5cdFx0fVxuXHRcdGM9ICcweCcrYy5qb2luKCcnKTtcblx0XHRyZXR1cm4gJ3JnYmEoJytbKGM+PjE2KSYyNTUsIChjPj44KSYyNTUsIGMmMjU1XS5qb2luKCcsJykrJywnKyB0cmFuc3BhcmVudCArJyknO1xuXHR9XG4gIHRocm93IG5ldyBFcnJvcignQmFkIEhleCcpO1xufTtcblxuXG5cbi8qIDA5LiBIYW5kbGUgU2Nyb2xsIFRvXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVTY3JvbGxUbyA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgZWxtVHJpZ2dlckxpc3QgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1snKyBhcHAuc2Nyb2xsVG8uYXR0ciArJ10nKSk7XG5cdHZhciBlbG1MaXN0ID0gZWxtVHJpZ2dlckxpc3QubWFwKGZ1bmN0aW9uKGVsbSkge1xuXHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFxuXHRcdFx0dmFyIHRhcmdldEF0dHIgPSAoZWxtLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsVG8udGFyZ2V0KSkgPyB0aGlzLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsVG8udGFyZ2V0KSA6IHRoaXMuZ2V0QXR0cmlidXRlKGFwcC5zY3JvbGxUby5saW5rVGFyZ2V0KTtcblx0XHRcdHZhciB0YXJnZXRFbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRhcmdldEF0dHIpWzBdO1xuXHRcdFx0dmFyIHRhcmdldEhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYXBwLmhlYWRlci5pZClbMF07XG5cdFx0XHR2YXIgdGFyZ2V0SGVpZ2h0ID0gdGFyZ2V0SGVhZGVyLm9mZnNldEhlaWdodDtcblx0XHRcdGlmICh0YXJnZXRFbG0pIHtcblx0XHRcdFx0dmFyIHRhcmdldFRvcCA9IHRhcmdldEVsbS5vZmZzZXRUb3AgLSB0YXJnZXRIZWlnaHQgLSAyNDtcblx0XHRcdFx0d2luZG93LnNjcm9sbFRvKHt0b3A6IHRhcmdldFRvcCwgYmVoYXZpb3I6ICdzbW9vdGgnfSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn07XG5cblxuXG4vKiAxMC4gSGFuZGxlIFRvZ2dsZSBDbGFzc1xuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlVG9nZ2xlQ2xhc3MgPSBmdW5jdGlvbigpIHtcblx0dmFyIGVsbUxpc3QgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1snKyBhcHAudG9nZ2xlQ2xhc3MudG9nZ2xlQXR0ciArJ10nKSk7XG5cdFxuXHRlbG1MaXN0Lm1hcChmdW5jdGlvbihlbG0pIHtcblx0XHRlbG0ub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFxuXHRcdFx0dmFyIHRhcmdldFRvZ2dsZUNsYXNzID0gdGhpcy5nZXRBdHRyaWJ1dGUoYXBwLnRvZ2dsZUNsYXNzLnRvZ2dsZUF0dHIpO1xuXHRcdFx0dmFyIHRhcmdldERpc21pc3NDbGFzcyA9IHRoaXMuZ2V0QXR0cmlidXRlKGFwcC5kaXNtaXNzQ2xhc3MudG9nZ2xlQXR0cik7XG5cdFx0XHR2YXIgdGFyZ2V0VG9nZ2xlRWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLmdldEF0dHJpYnV0ZShhcHAudG9nZ2xlQ2xhc3MudGFyZ2V0QXR0cikpO1xuXHRcdFxuXHRcdFx0aWYgKCF0YXJnZXREaXNtaXNzQ2xhc3MpIHtcblx0XHRcdFx0aWYgKHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0VG9nZ2xlQ2xhc3MpKSB7XG5cdFx0XHRcdFx0dGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0VG9nZ2xlQ2xhc3MpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuYWRkKHRhcmdldFRvZ2dsZUNsYXNzKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKCF0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldFRvZ2dsZUNsYXNzKSAmJiAhdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5jb250YWlucyh0YXJnZXREaXNtaXNzQ2xhc3MpKSB7XG5cdFx0XHRcdFx0aWYgKHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0VG9nZ2xlQ2xhc3MpKSB7XG5cdFx0XHRcdFx0XHR0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LnJlbW92ZSh0YXJnZXRUb2dnbGVDbGFzcyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuYWRkKHRhcmdldFRvZ2dsZUNsYXNzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0VG9nZ2xlQ2xhc3MpKSB7XG5cdFx0XHRcdFx0XHR0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LnJlbW92ZSh0YXJnZXRUb2dnbGVDbGFzcyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuYWRkKHRhcmdldFRvZ2dsZUNsYXNzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0RGlzbWlzc0NsYXNzKSkge1xuXHRcdFx0XHRcdFx0dGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0RGlzbWlzc0NsYXNzKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5hZGQodGFyZ2V0RGlzbWlzc0NsYXNzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufVxuXG5cblxuLyogMTEuIEhhbmRsZSBUaGVtZSBQYW5lbFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlVGhlbWVQYW5lbCA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdC8vIDEyLjEgVGhlbWUgUGFuZWwgLSBUb2dnbGUgLyBEaXNtaXNzXG5cdHZhciBlbG1MaXN0ID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbJysgYXBwLnRoZW1lUGFuZWwudG9nZ2xlQXR0ciArJ10nKSk7XG5cdFxuXHRlbG1MaXN0Lm1hcChmdW5jdGlvbihlbG0pIHtcblx0XHRlbG0ub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFxuXHRcdFx0dmFyIHRhcmdldENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyk7XG5cdFx0XHR2YXIgdGFyZ2V0RXhwYW5kID0gZmFsc2U7XG5cdFx0XG5cdFx0XHRpZiAodGFyZ2V0Q29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyhhcHAudGhlbWVQYW5lbC5hY3RpdmVDbGFzcykpIHtcblx0XHRcdFx0dGFyZ2V0Q29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoYXBwLnRoZW1lUGFuZWwuYWN0aXZlQ2xhc3MpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFyZ2V0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoYXBwLnRoZW1lUGFuZWwuYWN0aXZlQ2xhc3MpO1xuXHRcdFx0XHR0YXJnZXRFeHBhbmQgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKENvb2tpZXMpIHtcblx0XHRcdFx0Q29va2llcy5zZXQoYXBwLnRoZW1lUGFuZWwuY29va2llTmFtZSwgdGFyZ2V0RXhwYW5kKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXHRcblx0Ly8gMTIuMiBUaGVtZSBQYW5lbCAtIFBhZ2UgTG9hZCBDb29raWVzIFxuXHRpZiAoQ29va2llcykge1xuXHRcdHZhciB0aGVtZVBhbmVsRXhwYW5kID0gQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwuY29va2llTmFtZSk7XG5cdFx0XG5cdFx0aWYgKHRoZW1lUGFuZWxFeHBhbmQgPT0gJ3RydWUnIHx8IHR5cGVvZiB0aGVtZVBhbmVsRXhwYW5kID09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHR2YXIgZWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignWycrIGFwcC50aGVtZVBhbmVsLnRvZ2dsZUF0dHIgKyddJyk7XG5cdFx0XHRpZiAoZWxtKSB7XG5cdFx0XHRcdGVsbS5jbGljaygpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0XG5cdC8vIDEyLjMgVGhlbWUgUGFuZWwgLSBUaGVtZSBTZWxlY3RvclxuXHR2YXIgZWxtTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZS50b2dnbGVBdHRyICsnXScpKTtcblx0ZWxtTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XG5cdFx0ZWxtLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcblx0XHRcdGZvciAodmFyIHggPSAwOyB4IDwgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QubGVuZ3RoOyB4KyspIHtcblx0XHRcdFx0dmFyIHRhcmdldENsYXNzID0gZG9jdW1lbnQuYm9keS5jbGFzc0xpc3RbeF07XG5cdFx0XHRcdGlmICh0YXJnZXRDbGFzcy5zZWFyY2goJ3RoZW1lLScpID4gLTEpIHtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0Q2xhc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XG5cdFx0XHR2YXIgdGFyZ2V0VGhlbWUgPSB0aGlzLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZS5jbGFzc0F0dHIpO1xuXHRcdFx0dmFyIHRhcmdldFRoZW1lTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZS50b2dnbGVBdHRyICsnXScpKTtcblx0XHRcdFxuXHRcdFx0aWYgKHRhcmdldFRoZW1lKSB7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCh0YXJnZXRUaGVtZSk7XG5cdFx0XHR9XG5cdFx0XHR0YXJnZXRUaGVtZUxpc3QubWFwKGZ1bmN0aW9uKHRhcmdldEVsbSkge1xuXHRcdFx0XHRpZiAodGFyZ2V0RWxtLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZS5jbGFzc0F0dHIpICE9IHRhcmdldFRoZW1lKSB7XG5cdFx0XHRcdFx0dGFyZ2V0RWxtLmNsb3Nlc3QoJy4nKyBhcHAudGhlbWVQYW5lbC50aGVtZUxpc3RJdGVtQ0xhc3MpLmNsYXNzTGlzdC5yZW1vdmUoYXBwLnRoZW1lUGFuZWwudGhlbWUuYWN0aXZlQ2xhc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5jbG9zZXN0KCcuJysgYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0SXRlbUNMYXNzKS5jbGFzc0xpc3QuYWRkKGFwcC50aGVtZVBhbmVsLnRoZW1lLmFjdGl2ZUNsYXNzKTtcblx0XHRcdFxuXHRcdFx0aWYgKENvb2tpZXMpIHtcblx0XHRcdFx0Q29va2llcy5zZXQoYXBwLnRoZW1lUGFuZWwudGhlbWUuY29va2llTmFtZSwgdGFyZ2V0VGhlbWUpO1xuXHRcdFx0XHRhcHAuY29sb3IudGhlbWUgPSAoZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKCctLWJzLXRoZW1lJykpLnRyaW0oKTtcblx0XHRcdFx0YXBwLmNvbG9yLnRoZW1lUmdiID0gKGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZSgnLS1icy10aGVtZS1yZ2InKSkudHJpbSgpO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3RoZW1lLXJlbG9hZCcpKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXHRcblx0aWYgKENvb2tpZXMpIHtcblx0XHRpZiAoQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwudGhlbWUuY29va2llTmFtZSkpIHtcblx0XHRcdHZhciB0YXJnZXRFbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MgKycgWycrIGFwcC50aGVtZVBhbmVsLnRoZW1lLnRvZ2dsZUF0dHIgKyddJyArICdbJysgYXBwLnRoZW1lUGFuZWwudGhlbWUuY2xhc3NBdHRyICsnPVwiJysgQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwudGhlbWUuY29va2llTmFtZSkgKydcIl0nKTtcblx0XHRcdFxuXHRcdFx0aWYgKHRhcmdldEVsbSkge1xuXHRcdFx0XHR0YXJnZXRFbG0uY2xpY2soKTtcblx0XHRcdFxuXHRcdFx0XHRhcHAuY29sb3IudGhlbWUgPSAoZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKCctLWJzLXRoZW1lJykpLnRyaW0oKTtcblx0XHRcdFx0YXBwLmNvbG9yLnRoZW1lUmdiID0gKGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZSgnLS1icy10aGVtZS1yZ2InKSkudHJpbSgpO1xuXHRcdFx0XG5cdFx0XHRcdGRvY3VtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCd0aGVtZS1yZWxvYWQnKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRcblx0Ly8gMTIuNCBUaGVtZSBQYW5lbCAtIEJhY2tncm91bmQgU2VsZWN0b3Jcblx0dmFyIGVsbUxpc3QgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyArJyBbJysgYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci50b2dnbGVBdHRyICsnXScpKTtcblx0ZWxtTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XG5cdFx0ZWxtLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcblx0XHRcdHZhciBodG1sRWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuXHRcdFx0dmFyIHRhcmdldFRoZW1lID0gdGhpcy5nZXRBdHRyaWJ1dGUoYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci5jbGFzc0F0dHIpO1xuXHRcdFx0Zm9yICh2YXIgeCA9IDA7IHggPCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0Lmxlbmd0aDsgeCsrKSB7XG5cdFx0XHRcdHZhciB0YXJnZXRDbGFzcyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3RbeF07XG5cdFx0XHRcdGlmICh0YXJnZXRDbGFzcy5zZWFyY2goJ2JnLWNvdmVyLScpID4gLTEpIHtcblx0XHRcdFx0XHRodG1sRWxtLmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0Q2xhc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICh0YXJnZXRUaGVtZSkge1xuXHRcdFx0XHRodG1sRWxtLmNsYXNzTGlzdC5hZGQodGFyZ2V0VGhlbWUpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR2YXIgdGFyZ2V0Q292ZXJMaXN0ID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJysgYXBwLnRoZW1lUGFuZWwuY2xhc3MgKycgWycrIGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXIudG9nZ2xlQXR0ciArJ10nKSk7XG5cdFx0XHR0YXJnZXRDb3Zlckxpc3QubWFwKGZ1bmN0aW9uKHRhcmdldEVsbSkge1xuXHRcdFx0XHRpZiAodGFyZ2V0RWxtLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZUNvdmVyLnRvZ2dsZUF0dHIpICE9IHRhcmdldFRoZW1lKSB7XG5cdFx0XHRcdFx0dGFyZ2V0RWxtLmNsb3Nlc3QoJy4nKyBhcHAudGhlbWVQYW5lbC50aGVtZUNvdmVySXRlbUNsYXNzKS5jbGFzc0xpc3QucmVtb3ZlKGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXIuYWN0aXZlQ2xhc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5jbG9zZXN0KCcuJysgYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlckl0ZW1DbGFzcykuY2xhc3NMaXN0LmFkZChhcHAudGhlbWVQYW5lbC50aGVtZUNvdmVyLmFjdGl2ZUNsYXNzKTtcblx0XHRcdGlmIChDb29raWVzKSB7XG5cdFx0XHRcdENvb2tpZXMuc2V0KGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXIuY29va2llTmFtZSwgdGFyZ2V0VGhlbWUpO1xuXHRcdFx0fVxuXHRcdH07XG5cdH0pO1xuXHRcblx0aWYgKENvb2tpZXMpIHtcblx0XHRpZiAoQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci5jb29raWVOYW1lKSkge1xuXHRcdFx0dmFyIHRhcmdldEVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyArJyBbJysgYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci50b2dnbGVBdHRyICsnXScgKyAnWycrIGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXIuY2xhc3NBdHRyICsnPVwiJysgQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci5jb29raWVOYW1lKSArJ1wiXScpO1xuXHRcdFx0aWYgKHRhcmdldEVsbSkge1xuXHRcdFx0XHR0YXJnZXRFbG0uY2xpY2soKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdFxuXHQvLyAxMi41IFRoZW1lIFBhbmVsIC0gTW9kZSBTZWxlY3RvclxuXHR2YXIgZWxtcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZU1vZGUudG9nZ2xlQXR0ciArJ10nKSk7XG5cdGVsbXMubWFwKGZ1bmN0aW9uKGVsbSkge1xuXHRcdGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XG5cdFx0XHR2YXIgdGFyZ2V0RWxtID0gdGhpcztcblx0XHRcdHZhciB0YXJnZXRNb2RlID0gKHRhcmdldEVsbS5nZXRBdHRyaWJ1dGUoYXBwLnRoZW1lUGFuZWwudGhlbWVNb2RlLnZhbHVlQXR0cikpID8gdGFyZ2V0RWxtLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZU1vZGUudmFsdWVBdHRyKSA6ICcnO1xuXHRcdFxuXHRcdFx0aWYgKHRhcmdldE1vZGUgPT0gJ2RhcmsnKSB7XG5cdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5zZXRBdHRyaWJ1dGUoYXBwLnRoZW1lUGFuZWwudGhlbWVNb2RlLmF0dHIsIHRhcmdldE1vZGUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpLnJlbW92ZUF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZU1vZGUuYXR0cik7XG5cdFx0XHR9XG5cdFx0XHRpZiAoQ29va2llcykge1xuXHRcdFx0XHRDb29raWVzLnNldChhcHAudGhlbWVQYW5lbC50aGVtZU1vZGUuY29va2llTmFtZSwgdGFyZ2V0TW9kZSk7XG5cdFx0XHR9XG5cdFx0XHR0YXJnZXRFbG0uY2xhc3NMaXN0LmFkZChhcHAudGhlbWVQYW5lbC50aGVtZU1vZGUuYWN0aXZlQ2xhc3MpO1xuXHRcdFx0XG5cdFx0XHR2YXIgZWxtczIgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nKyBhcHAudGhlbWVQYW5lbC5jbGFzcyArJyBbJysgYXBwLnRoZW1lUGFuZWwudGhlbWVNb2RlLnRvZ2dsZUF0dHIgKyddJykpO1xuXHRcdFx0ZWxtczIubWFwKGZ1bmN0aW9uKGVsbTIpIHtcblx0XHRcdFx0aWYgKGVsbTIgIT0gdGFyZ2V0RWxtKSB7XG5cdFx0XHRcdFx0ZWxtMi5jbGFzc0xpc3QucmVtb3ZlKGFwcC50aGVtZVBhbmVsLnRoZW1lTW9kZS5hY3RpdmVDbGFzcyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHRoYW5kbGVDc3NWYXJpYWJsZSgpO1xuXHRcdFx0ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3RoZW1lLXJlbG9hZCcpKTtcblx0XHR9XG5cdH0pO1xuXHRcblx0aWYgKENvb2tpZXMpIHtcblx0XHRpZiAoQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwudGhlbWVNb2RlLmNvb2tpZU5hbWUpKSB7XG5cdFx0XHR2YXIgdGFyZ2V0RWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrIGFwcC50aGVtZVBhbmVsLmNsYXNzICsnIFsnKyBhcHAudGhlbWVQYW5lbC50aGVtZU1vZGUudG9nZ2xlQXR0ciArJ10nICsgJ1snKyBhcHAudGhlbWVQYW5lbC50aGVtZU1vZGUudmFsdWVBdHRyICsnPVwiJysgQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwudGhlbWVNb2RlLmNvb2tpZU5hbWUpICsnXCJdJyk7XG5cdFx0XHRpZiAodGFyZ2V0RWxtKSB7XG5cdFx0XHRcdHRhcmdldEVsbS5jbGljaygpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuXG5cbi8qIDEyLiBIYW5kbGUgQ1NTIFZhcmlhYmxlXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVDc3NWYXJpYWJsZSA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgcm9vdFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KTtcblx0XG5cdC8vIGZvbnRcblx0aWYgKGFwcC52YXJpYWJsZUZvbnRMaXN0ICYmIGFwcC52YXJpYWJsZVByZWZpeCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgKGFwcC52YXJpYWJsZUZvbnRMaXN0KS5sZW5ndGg7IGkrKykge1xuXHRcdFx0YXBwLmZvbnRbYXBwLnZhcmlhYmxlRm9udExpc3RbaV0ucmVwbGFjZSgvLShbYS16fDAtOV0pL2csIChtYXRjaCwgbGV0dGVyKSA9PiBsZXR0ZXIudG9VcHBlckNhc2UoKSldID0gcm9vdFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tJysgYXBwLnZhcmlhYmxlUHJlZml4ICsgYXBwLnZhcmlhYmxlRm9udExpc3RbaV0pLnRyaW0oKTtcblx0XHR9XG5cdH1cblx0XG5cdC8vIGNvbG9yXG5cdGlmIChhcHAudmFyaWFibGVDb2xvckxpc3QgJiYgYXBwLnZhcmlhYmxlUHJlZml4KSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAoYXBwLnZhcmlhYmxlQ29sb3JMaXN0KS5sZW5ndGg7IGkrKykge1xuXHRcdFx0YXBwLmNvbG9yW2FwcC52YXJpYWJsZUNvbG9yTGlzdFtpXS5yZXBsYWNlKC8tKFthLXp8MC05XSkvZywgKG1hdGNoLCBsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKV0gPSByb290U3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS0nKyBhcHAudmFyaWFibGVQcmVmaXggKyBhcHAudmFyaWFibGVDb2xvckxpc3RbaV0pLnRyaW0oKTtcblx0XHR9XG5cdH1cbn07XG5cblxuXG4vKiAxMy4gQXBwbGljYXRpb24gQ29udHJvbGxlclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgQXBwID0gZnVuY3Rpb24gKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdHJldHVybiB7XG5cdFx0Ly9tYWluIGZ1bmN0aW9uXG5cdFx0aW5pdDogZnVuY3Rpb24gKCkge1xuXHRcdFx0dGhpcy5pbml0Q29tcG9uZW50KCk7XG5cdFx0XHR0aGlzLmluaXRTaWRlYmFyKCk7XG5cdFx0XHR0aGlzLmluaXRBcHBMb2FkKCk7XG5cdFx0fSxcblx0XHRpbml0QXBwTG9hZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LmFkZChhcHAuaW5pdC5jbGFzcyk7XG5cdFx0fSxcblx0XHRpbml0U2lkZWJhcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRoYW5kbGVTaWRlYmFyTWVudSgpO1xuXHRcdFx0aGFuZGxlU2lkZWJhclNjcm9sbE1lbW9yeSgpO1xuXHRcdH0sXG5cdFx0aW5pdENvbXBvbmVudDogZnVuY3Rpb24oKSB7XG5cdFx0XHRoYW5kbGVTY3JvbGxiYXIoKTtcblx0XHRcdGhhbmRsZVNjcm9sbFRvVG9wQnV0dG9uKCk7XG5cdFx0XHRoYW5kbGVTY3JvbGxUbygpO1xuXHRcdFx0aGFuZGxlQ2FyZEFjdGlvbigpO1xuXHRcdFx0aGFuZGVsVG9vbHRpcFBvcG92ZXJBY3RpdmF0aW9uKCk7XG5cdFx0XHRoYW5kbGVUb2dnbGVDbGFzcygpO1xuXHRcdFx0aGFuZGxlVGhlbWVQYW5lbCgpO1xuXHRcdFx0aGFuZGxlQ3NzVmFyaWFibGUoKTtcblx0XHR9LFxuXHRcdHNjcm9sbFRvcDogZnVuY3Rpb24oKSB7XG5cdFx0XHR3aW5kb3cuc2Nyb2xsVG8oe3RvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnfSk7XG5cdFx0fVxuXHR9O1xufSgpO1xuXG5cblxuLyogMTQuIEluaXRpYWxpc2Vcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuXHRBcHAuaW5pdCgpO1xufSk7Il19
